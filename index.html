<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/customize.css"> <!-- Customized by alareo -->
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/test/sl1.css">
		<link rel="stylesheet" href="css/theme/moon.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section> <!-- Portada -->
					<div class="sl1"> 
						<h1 data-heading="Introducción a R">Introducción a R</h1>
						<h3>Lenguaje de programación de código abierto orientado a la estadística</h3>
						<p>
							<small>Ángel Lareo. Universidad Autónoma de Madrid. Grupo de Neurocomputación Biológica</small>
						</p>
					</div>
				</section>

				<section> <!-- R Intro-->
						<h2>Sintaxis básica de R</h2>
						<section>
						<ul>
							<li>Comentarios (no se ejecutan) con #</li>
							<pre><code># esto es un comentario</code></pre>
							<li>Asignación de variables</li>
							<pre><code data-trim data-noescape>
								variable <- 1 ## variable contiene un 1
								3 -> variable ## variable contiene un 3 </code></pre>
							<li>R es sensible a mayúsculas</li>
							<pre><code data-trim data-noescape>
								a <- 3
								A <- 4
							</code></pre>
						</ul>
						</section>
						<section>
							<div class="container">
								<div class="col">
								<ul>
								  <li>Operadores aritméticos:</li>
								  	<div class="container smallfont">
								  		<div class="col2">
										<ul>
											<li>Suma </li>
									 		<li>Resta </li>
											<li>Multiplicación </li>
											<li>División </li>
											<li>División entera</li>
											<li>Elevar </li>
											<li>Módulo </li>
										</ul>
										</div>
										<div class="col">
										+ <br/>
										- <br/>
										* <br/>
										/ <br/>
										%/% <br/>
										** o ^ <br/>
										%% <br/>
										</div>
									</div>
								</ul>
								</div>
								<div class="col">
									<pre><code data-trim data-noescape>
										a <- 2		# a es 2
										b <- a + 3	# b es 5
										c <- b %/% a 	# c es ??
										r <- b %% a 	# r es ??
									</code></pre>
								</div>
							</div>
						</section> 
						<section>
							<div class="container">
								<div class="col">
								<ul>
								  <li>Operadores lógicos:</li>
								  	<div class="container smallfont">
								  		<div class="col2">
									  	<ul>
									  		<li>Igual</li>
									  		<li>Mayor (igual)</li>
											<li>Menor (igual)</li>
									  		<li>Desigual</li>
									  		<li>Or</li>
									  		<li>And</li>
									  		<li>Not</li>
									  		<li>isTRUE(x)</li>
									    </ul>
										</div>
										<div class="col">
											== <br>
											> (>=) <br>
											< (<=) <br>
											!= <br>
											| <br>
											& <br>
											! <br>
										</div>
								</ul>
								</div>
								<div class="col">
									<pre><code data-trim data-noescape>
										a <- 3
										A <- 4
										a != A # TRUE
									</code></pre>
								</div>
							</div>
						</ul>
						</section>
						<section>
						<ul>
							<li>Símbolos especiales:</li>
							<div class="container smallfont">
								<div class="col">
								<ul>
									<li>NA</li>
									<li>NaN</li>
									<li>Inf</li>
									<li>NULL</li>
									<li>TRUE</li>
									<li>FALSE</li>
								</ul>
								</div>
								<div class="col2">
									Valor faltante <br>
									Valor indefinido <br>
									Infinito <br>
									Valor nulo <br>
								</div>
							</div>
						</ul>
						</section>
				</section>
				<section>
					<section>
					<h2>¿Por qué orientado a la <b>estadística</b>?</h2>
					<ul>
						<li>Funciones estadísticas comunes (ya vienen hechas)</li>
						<li>Permite hacer gráficas (para visualizar los datos y resultados)</li>
						<li>Extensiones (alguien lo hizo antes y lo puedes reutilizar)</li>
					</ul>
					</section>
					<section>
						<h2>Extensiones</h2>
						<pre><code data-trim data-noescape>						
							# Install new packages just for the first time 
							install.packages("ggplot2")

							#Then load them
							library(ggplot2)

							#Now you can use the functions in the package...
							</code></pre>
					</section>
					<section> 
						<h2>Gráficas simples con R</h2>
						<div class="container">
							<div class="col2">
								<pre><code data-trim data-noescape>
								# Create empty example plot 
								plot(0, 0, col = "white", xlab = "", ylab = "") 
								  
								# Draw one line 
								segments(x0 = -1, y0 = -0.5, 
									 x1 = 0.5, y1 = 0, 
									 col = "darkgreen")  
								</code></pre>
							</div>
							<div class="col">
								<span class="image"> <img src="img/plot-segment.png" width="300" alt=""> </span>
							</div>
						</div>
					</section>
					<section>
						<h2>Funciones estadísticas comunes</h2>
						<div class="container">
							<div class="col2">
								<pre><code data-trim data-noescape>
								# define grid
								p_grid <- seq(from=0, to=1, length.out=20)

								# define prior
								prior <- rep(1, 20)

								# compute likelihood at each value in grid
								likelihood <- dbinom(6, size=9, prob=p_grid)

								# compute product of likelihood and prior
								unstd.posterior <- likelihood * prior

								# standardize the posterior, so it sums to 1
								posterior <- unstd.posterior / sum(unstd.posterior)
								</code></pre>
							</div>
							<div class="col">
								<pre><code data-trim data-noescape>
								plot(p_grid, posterior, type="b",
								xlab="probability of water", 
								ylab="posterior probability")
								mtext("20 points")
								</code></pre>
								<span class="image"> <img src="img/probability-example.png" width="300" alt=""> </span>
							</div>
						</div>
					</section> 
				</section>

				<section> <!-- R Studio-->
					<section>
					<h2><b>R Studio</b>: Entorno de desarrollo (IDE)</h2>
					<p>
						No te libras del código, pero con R studio puedes visualizar datos, gráficas y hacer alguna cosa con el ratón.
					</p>
					</section>
					<section>
						<img src="img/RStudio-IDE.png" alt="Explicación de RStudio IDE: Editor (arriba izquierda), Workspace (arriba derecha), Consola (abajo izquierda), Varios (abajo derecha)">
					</section> 
					<section>
					<h2>Funciones de ayuda</h2>
					<pre><code data-trim data-noescape>
							help.start()		# general help

							help(sqrt)		# help about function sqrt
							?sqrt	 		# same thing
							
							apropos("sqrt") 	# list all function containing string sqrt
							
							example(sqrt)		# show an example of function sqrt
							
							# search for sqrt in help manuals and archived mailing lists
							RSiteSearch("sqrt")
							
							# get vignettes (examples) on using installed packages
							vignette("sqrt") # show specific vignette
						</code></pre>
					</section>
					<section data-markdown>
						## Scripts R
						- Scripts: conjuntos de instrucciones que se ejecutan secuencialmente.
						- Nuevo script en RStudio: Archivo > Nuevo > Script R
							- Script en *Editor*.
							- Código se ejecuta en *Consola*
							- Gráficas se muestran en *Varios*
						- Ejecuta código seleccionando y pulsando Ctrl + Enter
						
					</section>
				</section>

				<section> <!-- Estructura proyecto-->
					<section>
						<h2>Estructura de proyecto R</h2>
						<div class="container">
								<div class="col">
									<ul>
										<li>Input</li>
										<li>Scripts</li>
										<li>Scripts/Functions</li>
										<li>Output/Data</li>
										<li>Output/Plots</li>
									</ul>
								</div>
								<div class="col2">
									<span class="image"> <img src="img/R-project-structure.png" alt=""> </span>
								</div>
							</div>
					</section>
					<section>
						<h2>Working directory</h2>
						Directorio "raíz" del proyecto. Las rutas relativas derivan de este.
						Se puede seleccionar con:
						<pre><code>setwd("/dir/to/root/directory/")</code></pre>
						Si quieres cargar un archivo de input:
						<pre><code>read.csv("input/2020_12_25_data.csv")</code></pre>
					</section>
					<section>
						<h2>Working directory en RStudio</h2>
						<span class="image"> <img src="img/RStudio-setwd.png" width="600px" alt=""> </span>
					</section>
				</section>

				<section> <!-- Tipos de variables -->
					<section>
						<h2>Tipos de variables R</h2>
						<ul>
							<li>Character (cadenas de caracteres)</li>
							<li>Numeric (números)</li>
							<li>Vectores (1 dimensión)</li>
							<li>Matrices (2 dimensiones)</li>
							<li>Array (3 o más dimensiones)</li>
						</ul>
					</section>
					<section>
						<h2>Fechas</h2>
						<p class="smallfont">Las fechas pueden representarse en tablas como números o como strings. Pero para que R las interprete de manera correcta como fechas, deben convertirse en un objeto de la clase <i>date</i> o bien un objeto de las clases <i>POSIXct/POSIXt</i>.</p>
						<pre><code data-trim data-noescape>
							x <- c("06/23/2013", "06/30/2013", "07/12/2014")
							class(x)
							# [1] "character"

							x <- as.POSIXct(x, format = "%m/%d/%y")
							class(x)
							# [1] "POSIXct" "POSIXt"
						</code></pre>
					</section>
					<section>
						<h2>Operaciones con fechas POSIXct</h2>
						<pre><code data-trim data-noescape>
							x[1] # "2020-06-23 CEST"
							as.character(x[1])
							# [1] "2020-06-23"

							x[2]-x[1] # Time difference of 7 days
							diff(x)
							# Time differences in days
							# [1]  7 12

							dif_in_days = as.numeric(diff(x))
							# [1]  7 12
						</code></pre>
					</section>
				</section>

				<section> <!-- Vectores -->
					<section>
						<h2>Vectores</h2>
						<ul>
							<li>Definimos nuevos vectores con función c()</li>
							<pre><code data-trim data-noescape>
							v_numeric <- c(2,10,0.1)
							v_bool <- c(TRUE, TRUE, FALSE)
							v_string <- c("hola","soy","1","vector")
							</code></pre>
							<li>Tb con función vector()</li>
							<pre><code data-trim data-noescape>
							new_v <- vector("numeric", length = 10)
							# x = 0 0 0 0 0 0 0 0 0 0
							</code></pre>
						</ul>
					</section>
					<section>
					<h2>Vectores II</h2>
						<ul>
							<li>Tb con seq()</li>
							<pre><code data-trim data-noescape>
							seq_v <- seq(from=12,to=30,by=3)
							# seq_v = 12 15 18 21 24 27 30

							seq_v2 <- seq(from=1.1,to=2,length=10)
							# seq_v2 = 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0
							</code></pre>
							<li>O con rep() para repetir valores</li>
							<pre><code data-trim data-noescape>
							rep_v <- rep(8,4)
							# rep_v = 8 8 8 8

							rep_v2 <- rep(1:3, 2)
							# rep_v2 = 1 2 3 1 2 3

							rep_v3 <- rep(c(14,8,3),3)
							# seq_v3 = 14 8 3 14 8 3 14 8 3
							</code></pre>
						</ul>
					</section>
					<section>
						<h2>Acceso a posiciones de un vector: Indexing</h2>
						<p>Accedemos con operador [pos]</p>
						<pre><code data-trim data-noescape>
							v_numeric[1] # Devuelve el 2 en la posición 1
							sub_v <- seq_v[1:3]
							# sub_v = 12 15 18
							sub_v[2] <- 0
							# sub_v = 12 0 18
						</code></pre>
						<p>La función length() nos devuelve la longitud del vector
						<pre><code data-trim data-noescape>
							length(c(1,2,3,4,5)) # 5
							sub_v <- seq_v[1:3]
							# sub_v = 12 15 18
						</code></pre>
					</section>
						<section>
							<h2>Operaciones aritméticas en vectores</h2>
							<div class="container">
							  		<div class="col smallfont">
									<ul>
										<li>sum() </li>
								 		<li>prod() </li>
										<li>cumsum()</li>
										<li>cumprod() </li>
										<li>min() </li>
										<li>max() </li>
										<li>diff()</li>
									</ul>
									</div>
									<div class="col2 smallfont">
									sumatorio del vector <br/>
									productorio del vector <br/>
									vector suma acumulado <br/>
									vector producto acumulado <br/>
									valor mínimo <br/>
									valor máximo <br/>
									vector de diferencias <br/>
									</div>
									<div class="col2">
										<pre><code data-trim data-noescape>
											a <- 2:4
											sum <- sum(a)	# a es 9
											prod <- prod(a) # a es 24
											cumsum(a) 	# 2 5 9
											cumprod(a)	# 2 6 24
											min <- min(a)	# min es 2
											max <- max(a)	# max es 4
										</code></pre>
									</div>
							</div>
						</section>
				</section>
				<section> <!-- Matrices -->
					<section>
						<h2>Matrices</h2>
						<p>Se crean con la función matrix</p>
						<pre><code data-trim data-noescape>
							m <- matrix(nrow = 2, ncol = 3)
							#     [,1] [,2] [,3]
							# [1,] NA   NA   NA
							# [2,] NA   NA   NA
						</code></pre>
						<p>byrow=TRUE indica que la matriz debe rellenarse por filas</p>
						<pre><code data-trim data-noescape>
							m<-matrix(1:12, ncol=4, byrow=TRUE)
							#      [,1] [,2] [,3] [,4]
							# [1,]   1    2    3    4
							# [2,]   5    6    7    8
							# [3,]   9   10   11   12
						</code></pre>
					</section>
					<section>
						<h2>Combinando vectores en una matriz</h2>
						<pre><code data-trim data-noescape>
							objects <- 1:3
							counts <- 10:12

							cbind(objects, counts)
							#      objects counts
							# [1,]    1      10 
							# [2,]    2      11  
							# [3,]    3      12  

							rbind(objects, counts)
							#          [,1] [,2] [,3]
							# objects    1    2    3 
							# counts    10   11   12
						</code></pre>
					</section>
					<section>
						<h2>Nombrar filas y columnas</h2>
						<p>La función colnames permite renombrar las <u>columnas</u> de una matriz</p>
						<pre><code data-trim data-noescape>
							colnames(m)<-c("date","data1","data2")
						</code></pre>
						<p>La función rownames permite renombrar las <u>filas</u> de una matriz</p>
						<pre><code data-trim data-noescape>
							rownames(m)<-c("entry0","entry1","entry2")
						</code></pre>
					</section>
					<section>
						<h2>Acceso indexado</h2>
						Con operador [row,column] 
						<pre><code data-trim data-noescape>
							m<-matrix(1:4, ncol=2, byrow=TRUE)
							#      [,1] [,2] 
							# [1,]   1    2  
							# [2,]   3    4 

							m[2,1] # 3
							m[1,]  # primera fila: 1 2 3 4
							m[,3]  # tercera columna: 3 7 11

							m[1,1] <- 0 # cambia un valor
							#      [,1] [,2] 
							# [1,]   0    2  
							# [2,]   3    4 
						</code></pre>
					</section>
					<section>
						<h2>Operaciones en matrices</h2>
						<pre><code data-trim data-noescape>
							dim(m) # 2 2 (get dimensions)
							length(m) # 4
							m[2,] <- 1 # toda la segunda fila a 1
							#      [,1] [,2] 
							# [1,]   0    2  
							# [2,]   1    1 

							m <- t(m) # transpose m
							#      [,1] [,2] 
							# [1,]   0    1  
							# [2,]   2    1

							m <- m[-2,] # delete second row
							#      [,1] [,2] 
							# [1,]   0    1  
						</code></pre>
					</section>
				</section>
				<section> <!-- Arrays -->
					<section>
						<h2>Arrays</h2>
						<p>Funcionan igual que las matrices, pero para más de 2 dimensiones.</p>
						<pre><code data-trim data-noescape>
							a <- array(1:24, dim=c(3,4,2))
							# , , 1
							# 	     [,1] [,2] [,3] [,4]
							# 	[1,]   1    4    7   10
							# 	[2,]   2    5    8   11
							# 	[3,]   3    6    9   12
							# , , 2
							# 	     [,1] [,2] [,3] [,4]
							# 	[1,]  13   16   19   22
							# 	[2,]  14   17   20   23
							# 	[3,]  15   18   21   24
						</code></pre>
					</section>
					<section>
						<h2>Arrays II</h2>
						<pre><code data-trim data-noescape>
						vector1 <- c(1,2,3)
						vector2 <- c(10,9,8)
						column.names <- c("COL1","COL2","COL3")
						row.names <- c("ROW1","ROW2","ROW3")
						matrix.names <- c("Matrix1","Matrix2")

						result <- array(
							c(vector1,vector2),
							dim = c(3,3,2),
							dimnames = list(row.names,column.names, matrix.names)
						)

						# , , Matrix1
						#      COL1 COL2 COL3
						# ROW1    1   10    1
						# ROW2    2    9    2
						# ROW3    3    8    3
						# , , Matrix2
						#      COL1 COL2 COL3
						# ROW1   10    1   10
						# ROW2    9    2    9
						# ROW3    8    3    8
						</code></pre>
					</section>
				</section>
				<section>
					<section>
						<h2>Factors</h2>
						<p class="smallfont">Muchas veces los datos se agrupan en categorías (e.g. Norte, Sur, Este, Oeste).</p>
						<pre><code data-trim data-noescape>
							directions <- c("North", "East", "South", "South")
							factor(directions)
							# [1] North East South South
							# Levels: East North South
							
							factor(directions, levels= c("North", "East", "South", "West"), labels=c("N","E","S","W”))
							# [1] N E S S
							# Levels: N E S W
						</code></pre>
						<p class="smallfont">En R, los conjuntos de datos agregados en categorías se almacenan en <u>factors</u>, un tipo especial de vector con datos por categorías.</p>
					</section>
					<section>
						<h2>Factors ordenados</h2>
						<pre><code data-trim data-noescape>
							status <- c("Lo", "Hi", "Med", "Med", "Hi")
							ordered.status <- factor(status, levels=c("Lo", "Med", "Hi"),ordered=TRUE)
							ordered.status
							# [1] Lo Hi Med Med Hi
							# Levels: Lo < Med < Hi

							table(status)
							# status
							# Hi Lo Med
							#  2  1  2

							table(ordered.status)
							# ordered.status
							# Lo Med Hi
							#  1   2  2
						</code></pre>
					</section>
				</section>
				<section> <!-- Dataframes -->
					<section>
						<h2>Dataframes</h2>
						<p>Hasta ahora los datos agregados en un contenedor eran todos del mismo tipo</p>
						<p>¿Qué utilizamos cuando queremos almacenar tablas con datos de distinto tipo? <u>Dataframes</u></p>
						<pre><code data-trim data-noescape>
							S<-as.factor(c("F","M","M","F"))
							Patients <- data.frame(age=c(31,32,40,50),sex=S)
							# age sex
							# 1 31 F
							# 2 32 M
							# 3 40 M
							# 4 50 F
						</code></pre>
					</section>
					<section>
						<h2>Dataframes a partir de matriz</h2>
						<pre><code data-trim data-noescape>
						m<-matrix(1:12, ncol=4, byrow=TRUE)
						#      [,1] [,2] [,3] [,4]
						# [1,]   1    2    3    4
						# [2,]   5    6    7    8
						# [3,]   9   10   11   12

						m.df<-as.data.frame(m)
						m.df<-as.data.frame(t(m))
						#   V1 V2 V3
						# 1  1  5  9
						# 2  2  6 10
						# 3  3  7 11
						# 4  4  8 12
						</code></pre>
					</section>
					<section>
						<h2>Dataframes a partir de vectores de datos</h2>
						<pre><code data-trim data-noescape>
							employee <- c("John Doe","Peter Gynn","Jolie Hope")
							salary <- c(21000, 23400, 26800)
							startdate <- as.Date(c("2010-11-1","2008-3-25","2007-3-14"))
							
							employ.data <- data.frame(employee, salary, startdate)
							
							str(employ.data)
							# 'data.frame': 3 obs. of 3 variables:
							# $ employee: Factor w/ 3 levels "John Doe","Jolie Hope",..: 1 3 2
							# $ salary: num 21000 23400 26800
							# $ startdate: Date, format: "2010-11-01" "2008-03-25" "2007-03-14"
						</code></pre>
					</section>
					<section>
						<h2>Cargando/guardando datos con CSV</h2>
						<p class="smallfont">Un archivo .csv es un archivo de valores separados por comas (comma separated values).</p>
						<pre><code data-trim data-noescape>
							# Carga en dataframe data el contenido del archivo.csv en la ruta
							data <- read.csv("ruta/al/archivo.csv")

							# Escribe en archivo.csv el contenido del dataframe data
							write.csv(data, "ruta/al/archivo.csv")
						</code></pre>
						<p class="smallfont">El acceso a datos con el nombre de columna utiliza el operador $</p>
						<pre><code data-trim data-noescape>
							data$date
							#    [1] "11/25/19 14:40:00" "11/25/19 14:40:20" ...
						</code></pre>
					</section>
				</section>
				<section>
					<section>
						<h2>Gráficas con ggplot2</h2>
						<p>ggplot2 es una librería de funciones para generar gráficas</p>
						<pre><code data-trim data-noescape>
							install.packages(“ggplot2”)
							library("ggplot2")
						</code></pre>
					</section>
					<section>
						<ul class="smallfont">
							<li><b>data</b>: los datos deben guardarse como dataframes</li>
							<li>coordinate system: describen espacio proyección 2D (cartesianas, map, polares...)</li>
							<li>aesthetics: características visuales (posición, colores, transparencia...)</li>
							<li>scales: para cada aesthetic cómo es transformada a los valores mostrados (log scale, color scales...)</li>
							<li>stats: transformaciones estadísticas</li>
							<li>facets: cómo se dividen los datos en subsets</li>
							<li>geoms: tipo de objeto que representa los datos (puntos, líneas, polígonos...)</li> 
						</ul>
					</section>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/external/external.js',
						condition: function() {
							return !!document.querySelector( '[data-external],[data-external-replace]' );
						}
					}
				]
			});
		</script>
	</body>
</html>
